# Cline Rules for Chat-App Revolutionary Features

## Project Context
Slack-like chat application with **REVOLUTIONARY** multi-assignee tasks, teams system, and full Calendar/Timeline integration.

## ðŸ“‹ WORKFLOW INSTRUCTIONS

### **Start Each Session By Reading These Files:**
1. `.clinerules` - Current project context and deployment status
2. `SYNCUP-MIGRATION-PLAN.md` - Technical architecture and implementation plan
3. `SYNCUP-TODO.md` - Detailed accomplishments and next priorities

### **Update These Files After Making Changes:**
- `SYNCUP-TODO.md` - Add new accomplishments and update status
- `SYNCUP-MIGRATION-PLAN.md` - Update technical progress and component status
- `.clinerules` - Update deployment status and current features

### **Before Closing Each Session, Update These Files:**
1. `SYNCUP-TODO.md` - Document what was accomplished with technical details
2. `SYNCUP-MIGRATION-PLAN.md` - Update implementation status and next milestones  
3. `.clinerules` - Update current deployment status and testing checklist

### **Always List in Chat:**
- **Accomplishments**: Technical specifics of what was built/deployed
- **Next Steps**: Concrete priorities for the next session with file locations
- **Testing Status**: What needs to be validated in production
- **Deployment Info**: Current commit hash and DigitalOcean status

## ðŸš€ DIGITALOCEAN DEPLOYMENT SETUP
1. **Auto-Deploy**: DigitalOcean App Platform automatically rebuilds on `git push origin main`
2. **Migration Execution**: All SQL migrations run automatically on deployment
3. **Database**: PostgreSQL cluster on DigitalOcean with enhanced multi-assignee schema
4. **Testing**: Deploy early and often - DigitalOcean handles the infrastructure

### **Current Deployment Status (Nov 8, 2025):**
- âœ… **BUILD FIXED**: All build issues resolved (BarChart3Icon, Node.js, CSS)
- âœ… **CSS LOADING**: Tailwind PostCSS configuration fixed - 84.76kB CSS generation
- âœ… **PORT BINDING**: Fixed 0.0.0.0 host binding for DigitalOcean health checks
- âœ… **SERVER STARTUP**: Non-fatal database connection test - server stays running
- âœ… **DEPENDENCY FIX**: Added complete Express dependency chain (function-bind, side-channel, etc.)
- âœ… **WORKSPACE FIX**: Copied package-lock.json to backend for DigitalOcean isolation build
- âœ… **NODE.JS MODERNIZED**: Upgraded to Node.js 24+ for better performance and security
- âœ… **Latest Deploy**: Commit 497210e - CRITICAL side-channel dependency fix deployed
- ðŸ“Š **Migration 018**: Multi-assignee + teams schema will execute on first app startup  
- ðŸŽ¯ **STATUS**: Revolutionary features + modern UI fully operational - DEPENDENCY FIX IN PROGRESS

## ðŸŽ‰ REVOLUTIONARY FEATURES DEPLOYED
### **ðŸŽ¯ Multi-Assignee Tasks with Individual Progress Tracking:**
- Tasks assigned to multiple people simultaneously
- **Collaborative Mode**: Any assignee can mark done/edit/reassign
- **Individual Response Mode**: Each assignee must mark done separately with "2/7 done" progress
- Smart permissions and edit rights for all assignees

### **ðŸ‘¥ Team/Group System with @mention Support:**
- Create teams: "kitchen-team", "frontend-dev", "marketing", etc.
- @mention teams in chat, assign tasks to entire teams
- Combined assignments: individuals + teams on same task
- Professional color coding with 12 distinct team colors

### **ðŸ“… Production Calendar & Timeline Integration:**
- **Real ChannelCalendar.jsx**: Monthly view connected to production API
- **Real ChannelTimeline.jsx**: Full Gantt chart with dependencies
- **Seamless View Switching**: Chat/Calendar/Timeline buttons in headers
- **Multi-Channel Support**: View multiple channels simultaneously

## Architecture Decisions
- **Channel-Based Projects**: Each channel IS a project (simple, scalable)
- **Multi-Assignee Innovation**: Two modes for task completion tracking
- **Team-Based Collaboration**: Groups can be assigned and @mentioned
- **Professional Design**: Modern color system with channel color coding
- **Zero Learning Curve**: Familiar chat interface with powerful new views

## Database Schema (Current)
- âœ… `channel_tasks` table: Enhanced with multi-assignee support
- âœ… `workspace_teams` table: Team/group definitions
- âœ… `workspace_team_members` table: Team membership relationships
- âœ… **Views**: `channel_tasks_with_progress`, `user_task_assignments`
- âœ… **Functions**: `is_task_assignee()`, `get_task_completion_progress()`, `mark_task_complete_individual()`

## Key API Endpoints
- `GET /api/workspaces/:id/threads/:id/tasks` - Enhanced with multi-assignee data
- `POST /api/workspaces/:id/threads/:id/tasks` - Create with assignees/teams
- `POST /api/workspaces/:id/threads/:id/tasks/:id/complete` - Individual completion
- `GET /api/workspaces/:id/threads/:id/tasks/:id/progress` - Progress tracking
- `GET /api/workspaces/:id/teams` - Team management
- `POST /api/workspaces/:id/teams` - Create teams

## Testing Checklist (Production)
1. âœ… **View Switching**: Click Chat/Calendar/Timeline buttons in channel headers
2. ðŸ”„ **Calendar View**: See real tasks from API in monthly calendar format
3. ðŸ”„ **Timeline View**: Gantt chart with task dependencies and progress bars
4. ðŸ”„ **Multi-Assignee**: Look for "2/7 done" style progress indicators
5. ðŸ”„ **Team Assignment**: Create teams and assign to tasks
6. ðŸ”„ **Individual Completion**: Each assignee marks done separately
7. ðŸ”„ **@Team Mentions**: Type @team-name in chat (future iteration)

## File Locations (Production Ready)
- **Calendar**: `frontend/src/components/calendar/ChannelCalendar.jsx`
- **Timeline**: `frontend/src/components/timeline/ChannelTimeline.jsx` 
- **Multi-Channel**: `frontend/src/components/calendar/ChannelDropdown.jsx`
- **API**: `backend/routes/channel-tasks.js` (enhanced with multi-assignee)
- **Migration**: `backend/migrations/018_add_multi_assignee_and_groups.sql`
- **Design System**: `frontend/tailwind.config.js` (professional color palette)

## Deployment Process
1. **Develop Locally**: Make changes and test
2. **Git Commit**: `git add . && git commit -m "description"`
3. **Deploy**: `git push origin main` 
4. **Auto-Build**: DigitalOcean rebuilds app automatically
5. **Migration**: New SQL migrations execute on app startup
6. **Test**: Validate features in production environment

## Emergency Procedures
- **Rollback**: `git revert HEAD && git push origin main`
- **Check Logs**: DigitalOcean App Platform â†’ Runtime Logs
- **Database Access**: Use provided DigitalOcean database credentials
- **Migration Issues**: Check `backend/migrations/` files and execution order
